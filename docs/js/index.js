let plan,$pane;const handleJson=e=>e.json(),handleText=e=>e.text(),$views=document.querySelector(".views"),$floorSelector=document.querySelector(".floor-selector"),$zoomSlider=document.querySelector(".zoom-slider"),$viewFragment=document.createDocumentFragment(),$floorFragment=document.createDocumentFragment(),views=[],floorOptions=[],hideNode=e=>e.hidden=!0,selectFloor=e=>{const{target:t}=e;$floorSelector.classList.toggle("expand"),t.hidden&&(floorOptions.forEach(hideNode),views.forEach(hideNode),t.hidden=!1,$pane=document.getElementById(t.dataset.ref),$pane.hidden=!1)},zoom=()=>document.body.style.setProperty("--custom-scale",$zoomSlider.value),setFloor=(e,t)=>{const o=document.createElement("div"),n=document.createElement("li");n.textContent=e.name,n.className="floor-option",floorOptions.push(n),o.hidden=n.hidden=!0,n.dataset.ref=o.id=`view${t}`,$floorFragment.appendChild(n),o.className="view",views.push(o),$viewFragment.appendChild(o),fetch(e.src).then(handleText).then(e=>{o.innerHTML=e;const t=o.querySelector("svg"),{width:n,height:l}=t.getBoundingClientRect(),r=Math.min(window.innerWidth/n,window.innerHeight/l);t.style.setProperty("--default-scale",r)})},dragNode=e=>{let t=0,o=0,n=0,l=0;const r=()=>{document.onmouseup=null,document.onmousemove=null},d=r=>{r.preventDefault(),t=n-r.clientX,o=l-r.clientY,e.style.setProperty("--x",`${e.offsetLeft-t}px`),e.style.setProperty("--y",`${e.offsetTop-o}px`)};$views.onmousedown=t=>{t.preventDefault(),n=t.clientX-parseInt(getComputedStyle(e).getPropertyValue("--x")),l=t.clientY-parseInt(getComputedStyle(e).getPropertyValue("--y")),document.onmouseup=r,document.onmousemove=d}},loadPlan=e=>{plan=e,plan.forEach(setFloor),$views.appendChild($viewFragment),$floorSelector.appendChild($floorFragment),$pane=document.querySelector(".view"),document.querySelector(".floor-option").hidden=!1,$pane.hidden=!1,dragNode($pane),$floorSelector.addEventListener("click",selectFloor),$zoomSlider.addEventListener("input",zoom)};fetch("plan.json").then(handleJson).then(loadPlan);